def format_bin_label(bin_str):
    import re

    match = re.findall(r"[-+]?\d*\.\d+|\d+", bin_str)
    if not match:
        return bin_str

    nums = [float(m) for m in match]
    left_raw = bin_str.strip().split(',')[0]
    right_raw = bin_str.strip().split(',')[1] if ',' in bin_str else ''
    left_inf = '-inf' in left_raw.lower()
    right_inf = 'inf' in right_raw.lower()

    def smart_fmt(x):
        if x >= 100:
            return f"{round(x / 1000)}k"
        elif x.is_integer():
            return str(int(x))
        else:
            return f"{round(x, 2)}"

    if left_inf and not right_inf:
        return f"<= {smart_fmt(nums[0])}"
    elif right_inf and not left_inf:
        return f"> {smart_fmt(nums[0])}"
    elif not left_inf and not right_inf:
        return f"{smart_fmt(nums[0])} - {smart_fmt(nums[1])}"
    else:
        return bin_str  # fallback